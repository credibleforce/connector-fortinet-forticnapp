{
  "name": "fortinet-forticnapp_dev",
  "version": "1.1.0",
  "label": "Lacework FortiCNAPP",
  "description": "Lacework delivers end-to-end visibility into what\u2019s happening across your cloud environment, including detecting threats, vulnerabilities, misconfigurations, and unusual activity, so you can innovate with speed and safety.",
  "publisher": "Fortinet",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "category": "Cloud Security",
  "configuration": {
      "fields": [
          {
              "title": "Server URL",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "server_url",
              "description": "Specify the URL of the Lacework server to connect and perform the automated operations.",
              "tooltip": "Specify the URL to which you will connect and perform the automated operations."
          },
          {
              "title": "Key ID",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "keyId",
              "description": "Specify the access key ID configured for your account to access the Lacework endpoint.",
              "tooltip": "Specify the access key ID that is configured for your account to access the Lacework endpoint."
          },
          {
              "title": "Secret Key",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "password",
              "name": "secret",
              "description": "Specify the secret key configured for your account to access the Lacework endpoint.",
              "tooltip": "Specify the secret key that is configured for your account to access the Lacework endpoint."
          },
          {
              "title": "Verify SSL",
              "required": false,
              "editable": true,
              "visible": true,
              "type": "checkbox",
              "name": "verify_ssl",
              "value": true,
              "description": "Specifies whether the SSL certificate for the server is to be verified. By default, this option is selected, i.e., set to true. ",
              "tooltip": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True."
          }
      ]
  },
  "operations": [
      {
        "operation": "lql_query",
        "title": "Query lacework using LQL",
        "description": "Retrieves a list of results from an LQL query.",
        "category": "investigation",
        "annotation": "lql_query",
        "output_schema": {},
        "enabled": true,
        "parameters": [
          {
            "title": "Start Time",
            "required": false,
            "editable": true,
            "visible": true,
            "type": "datetime",
            "name": "startTime",
            "tooltip": "By default, the value is 24 hours before the current time. Difference between start time and end time should not be greater than 7 Days.",
            "description": "(Optional) Specify the start time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is 24 hours before the current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
          },
          {
            "title": "End Time",
            "required": false,
            "editable": true,
            "visible": true,
            "type": "datetime",
            "name": "endTime",
            "tooltip": "By default, the value is current time. Difference between start time and end time should not be greater than 7 Days.",
            "description": "(Optional) Specify the end time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
          },
          {
            "title": "Limit",
            "required": false,
            "editable": true,
            "visible": true,
            "type": "integer",
            "name": "limit",
            "tooltip": "Specify an limit to the number of rows returned.",
            "description": "(Optional) Specify an limit to the number of rows returned."
          },
          {
            "title": "Query",
            "required": true,
            "editable": true,
            "visible": true,
            "type": "text",
            "name": "query",
            "tooltip": "Specify the LQL formatted query (e.g. {source {LW_CFG_AWS_EC2_SECURITY_GROUPS} return {RESOURCE_CONFIG}}).",
            "description": "(Optional) Specify the LQL formatted query (e.g. {source {LW_CFG_AWS_EC2_SECURITY_GROUPS} return {RESOURCE_CONFIG}})."
          }
        ]
      },
      {
        "operation": "search_host_vulnerabilities",
        "title": "Search Host Vulnerabilities",
        "description": "Retrieves a detailed list of vulnerability state based on filters like start time, account ID, severity, status, and other filter criteria that you have specified.",
        "category": "investigation",
        "annotation": "search_host_vulnerabilities",
        "output_schema": [
            {
                "cveProps": {},
                "cveRiskInfo": {},
                "cveRiskScore": {},
                "endTime": "",
                "evalCtx": {},
                "evalGuid": {},
                "featureKey": {},
                "fixInfo": {},
                "hostRiskInfo": {},
                "hostRiskScore": "",
                "machineTags": {},
                "mid": "",
                "packageStatus": "",
                "props": {},
                "region": "",
                "riskInfo": {},
                "riskScore": "",
                "severity": "",
                "startTime": "",
                "status": "",
                "vulnId": ""
            }
        ],
        "enabled": true,
        "parameters": [
            {
                "title": "Start Time",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "datetime",
                "name": "startTime",
                "tooltip": "By default, the value is 24 hours before the current time. Difference between start time and end time should not be greater than 7 Days.",
                "description": "(Optional) Specify the start time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is 24 hours before the current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
            },
            {
                "title": "End Time",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "datetime",
                "name": "endTime",
                "tooltip": "By default, the value is current time. Difference between start time and end time should not be greater than 7 Days.",
                "description": "(Optional) Specify the end time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
            },
            {
                "title": "Package Status",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "packageStatus",
                "options": [
                    "ACTIVE",
                    "INACTIVE"
                ],
                "tooltip": "Select the package status to filter vulnerability data",
                "description": "Select the package status to filter config vulnerability retrieved. You can select from the following options:  \n\nACTIVE \n\nINACTIVE "
            },
            {
                "title": "Kernel Status",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "props.kernel_status",
                "options": [
                    "Active",
                    "Inactive"
                ],
                "tooltip": "Select the kernel status to filter vulnerability data",
                "description": "Select the kernel status to filter config vulnerability retrieved. You can select from the following options:  \n\nACTIVE \n\nINACTIVE "
            },
            {
                "title": "Internet Reachability",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "riskInfo.host_risk_factors_breakdown.internet_reachability",
                "options": [
                    "Direct"
                ],
                "tooltip": "Select the internet reachability to filter vulnerability data",
                "description": "Select the internet reachability to filter config vulnerability retrieved. You can select from the following options:  \n\nDirect "
            },
            {
                "title": "Public Exploit Available",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "riskInfo.host_risk_factors_breakdown.exploit_summary.exploit_public",
                "options": [
                    "Yes",
                    "No"
                ],
                "tooltip": "Select the internet reachability to filter vulnerability data",
                "description": "Select the internet reachability to filter config vulnerability retrieved. You can select from the following options:  \n\nDirect "
            },
            {
                "title": "Fix Available",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "options": [
                    "0",
                    "1"
                ],
                "name": "fixInfo.fix_available",
                "tooltip": "Specify vulnerabilities with fix available to retrieve the specified vulnerability details.",
                "description": "(Optional) Specify vulnerabilities with fix available to retrieve the specified vulnerability details."
            },
            {
                "title": "AWS Account ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "machineTags.Account",
                "tooltip": "Specify an AWS Account ID to retrieve the specified vulnerability details.",
                "description": "(Optional) Specify an AWS Account ID to retrieve the specified vulnerability details."
            },
            {
                "title": "Azure Tenant ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "machineTags.TenantId",
                "tooltip": "Specify an Azure Tenant ID to retrieve the specified vulnerability details.",
                "description": "(Optional) Specify an Azure Tenant ID to retrieve the specified vulnerability details."
            },
            {
                "title": "Azure Subscription ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "machineTags.SubscriptionId",
                "tooltip": "Specify an Azure Subscription ID to retrieve the specified vulnerability details.",
                "description": "(Optional) Specify an Azure Subscription ID to retrieve the specified vulnerability details."
            },
            {
                "title": "GCP Project ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "machineTags.ProjectId",
                "tooltip": "Specify an GCP Project ID to retrieve the specified vulnerability details.",
                "description": "(Optional) Specify an GCP Project ID to retrieve the specified vulnerability details."
            },
            {
                "title": "AWS Instance ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "machineTags.InstanceId",
                "tooltip": "Specify an AWS instance ID to retrieve the specified vulnerability details (e.g. i-11112421523).",
                "description": "(Optional) Specify an AWS instance ID to retrieve the specified vulnerability details (e.g. i-11112421523)."
            },
            {
                "title": "AWS AMI ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "machineTags.AmiId",
                "tooltip": "Specify an AWS AMI ID to retrieve the specified vulnerability details.",
                "description": "(Optional) Specify an AWS AMI ID to retrieve the specified vulnerability details."
            },
            {
                "title": "Machine Hostname",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "machineTags.Hostname",
                "tooltip": "Specify a machine hostname to retrieve the specified vulnerability details.",
                "description": "(Optional) Specify a machine hostname to retrieve the specified vulnerability details."
            },
            {
                "title": "Machine Name",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "machineTags.Name",
                "tooltip": "Specify a machine name to retrieve the specified vulnerability details.",
                "description": "(Optional) Specify a machine name to retrieve the specified vulnerability details."
            },
            {
                "title": "Severity",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "severity",
                "options": [
                    "Critical",
                    "High",
                    "Medium",
                    "Low",
                    "Info"
                ],
                "tooltip": "Select severity to filter vulnerabilities.",
                "description": "(Optional) Select severity to filter vulnerabilities retrieved. You can select from the following options:  \n\nCritical \n\nHigh \n\nMedium \n\nLow \n\nInfo "
            },
            {
                "title": "Returns",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "returns",
                "tooltip": "Specify comma-separated list of top-level fields of the response schema you want to receive. e.g. alertId, alertName, alertType, alertInfo.",
                "description": "(Optional) Specify comma-separated list of top-level fields of the response schema to receive. For example: alertId, alertName, alertType, alertInfo. "
            }
        ]
      },
      {
        "operation": "search_container_vulnerabilities",
        "title": "Search Container Vulnerabilities",
        "description": "Retrieves a detailed list of vulnerability state based on filters like start time, account ID, severity, status, and other filter criteria that you have specified.",
        "category": "investigation",
        "annotation": "search_container_vulnerabilities",
        "output_schema": [
            {
                "cveProps": {},
                "evalCtx": {},
                "evalGuid": {},
                "featureKey": {},
                "featureProps": {},
                "packageStatus": "",
                "fixInfo": {},
                "imageId": "",
                "riskInfo": {},
                "riskScore": "",
                "cveRiskScore": "",
                "cveRiskInfo": "",
                "imageRiskInfo": {},
                "imageRiskScore": "",
                "severity": "",
                "startTime": "",
                "status": "",
                "vulnId": ""
            }
        ],
        "enabled": true,
        "parameters": [
            {
                "title": "Start Time",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "datetime",
                "name": "startTime",
                "tooltip": "By default, the value is 24 hours before the current time. Difference between start time and end time should not be greater than 7 Days.",
                "description": "(Optional) Specify the start time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is 24 hours before the current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
            },
            {
                "title": "End Time",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "datetime",
                "name": "endTime",
                "tooltip": "By default, the value is current time. Difference between start time and end time should not be greater than 7 Days.",
                "description": "(Optional) Specify the end time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
            },
            {
                "title": "Package Status",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "packageStatus",
                "options": [
                    "ACTIVE",
                    "INACTIVE"
                ],
                "tooltip": "Select the package status to filter vulnerability data",
                "description": "Select the package status to filter config vulnerability retrieved. You can select from the following options:  \n\nACTIVE \n\nINACTIVE "
            },
            {
                "title": "Internet Reachability",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "imageRiskInfo.factors_breakdown.internet_reachability",
                "options": [
                    "Direct"
                ],
                "tooltip": "Select the internet reachability to filter vulnerability data",
                "description": "Select the internet reachability to filter config vulnerability retrieved. You can select from the following options:  \n\nDirect "
            },
            {
                "title": "Public Exploit Available",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "imageRiskInfo.factors_breakdown.exploit_summary.exploit_public",
                "options": [
                    "Yes",
                    "No"
                ],
                "tooltip": "Select the internet reachability to filter vulnerability data",
                "description": "Select the internet reachability to filter config vulnerability retrieved. You can select from the following options:  \n\nDirect "
            },
            {
                "title": "Image ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "imageId",
                "tooltip": "Specify an AWS Account ID to retrieve the specified vulnerability details.",
                "description": "(Optional) Specify an AWS Account ID to retrieve the specified vulnerability details."
            },
            {
                "title": "Fix Available",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "options": [
                    0,
                    1
                ],
                "name": "fixInfo.fix_available",
                "tooltip": "Specify vulnerabilities with fix available to retrieve the specified vulnerability details.",
                "description": "(Optional) Specify vulnerabilities with fix available to retrieve the specified vulnerability details."
            },
            {
                "title": "Severity",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "severity",
                "options": [
                    "Critical",
                    "High",
                    "Medium",
                    "Low",
                    "Info"
                ],
                "tooltip": "Select severity to filter vulnerabilities.",
                "description": "(Optional) Select severity to filter vulnerabilities retrieved. You can select from the following options:  \n\nCritical \n\nHigh \n\nMedium \n\nLow \n\nInfo "
            },
            {
                "title": "Returns",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "returns",
                "tooltip": "Specify comma-separated list of top-level fields of the response schema you want to receive. e.g. alertId, alertName, alertType, alertInfo.",
                "description": "(Optional) Specify comma-separated list of top-level fields of the response schema to receive. For example: alertId, alertName, alertType, alertInfo. "
            }
        ]
      },
      {
        "operation": "search_configuration",
        "title": "Search Configuration",
        "description": "Retrieves a detailed list of config state based on filters like policy ID, start time, account ID, severity, status, and other filter criteria that you have specified.",
        "category": "investigation",
        "annotation": "search_configuration",
        "output_schema": [
            {
                "account": {},
                "evalType": "",
                "id": "",
                "reason": "",
                "recommendation": "",
                "region": "",
                "reportTime": "",
                "resource": "",
                "section": "",
                "severity": "",
                "status": ""
            }
        ],
        "enabled": true,
        "parameters": [
            {
                "title": "Start Time",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "datetime",
                "name": "startTime",
                "tooltip": "By default, the value is 24 hours before the current time. Difference between start time and end time should not be greater than 7 Days.",
                "description": "(Optional) Specify the start time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is 24 hours before the current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
            },
            {
                "title": "End Time",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "datetime",
                "name": "endTime",
                "tooltip": "By default, the value is current time. Difference between start time and end time should not be greater than 7 Days.",
                "description": "(Optional) Specify the end time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
            },
            {
                "title": "Dataset",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "dataset",
                "options": [
                    "AwsCompliance",
                    "AzureCompliance",
                    "GcpCompliance",
                    "K8sCompliance"
                ],
                "tooltip": "Select the dataset to filter config data",
                "description": "Select the source to filter config data retrieved. You can select from the following options:  \n\nAwsCompliance \n\nAzureCompliance \n\nGcpCompliance \n\nK8sCompliance "
            },
            {
                "title": "AWS Account ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "account.AccountId",
                "tooltip": "Specify an AWS Account ID to retrieve the specified config details.",
                "description": "(Optional) Specify an AWS Account ID to retrieve the specified config details."
            },
            {
                "title": "Azure Tenant ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "account.tenantId",
                "tooltip": "Specify an Azure Tenant ID to retrieve the specified config details.",
                "description": "(Optional) Specify an Azure Tenant ID to retrieve the specified config details."
            },
            {
                "title": "Azure Subscription ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "account.subscriptionId",
                "tooltip": "Specify an Azure Subscription ID to retrieve the specified config details.",
                "description": "(Optional) Specify an Azure Subscription ID to retrieve the specified config details."
            },
            {
                "title": "GCP Project ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "account.projectId",
                "tooltip": "Specify an GCP Project ID to retrieve the specified config details.",
                "description": "(Optional) Specify an GCP Project ID to retrieve the specified config details."
            },
            {
                "title": "Policy ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "id",
                "tooltip": "Specify a policy ID to retrieve the specified config details (e.g. lacework-global-634).",
                "description": "(Optional) Specify a policy ID to retrieve the specified config details (e.g. lacework-global-634)."
            },
            {
                "title": "Region",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "region",
                "tooltip": "Specify a resgion to retrieve the specified config details (e.g. us-east-1).",
                "description": "(Optional) Specify a region ID to retrieve the specified config details (e.g. us-east-1)."
            },
            {
                "title": "Resource ID",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "resource",
                "tooltip": "Specify a resource ID to retrieve the specified config details (e.g. arn:aws:kms:us-east-1:111111111:key/xxxx-xxx-xxxx-xxxxx).",
                "description": "(Optional) Specify an alert ID to retrieve the specified config details (e.g. arn:aws:kms:us-east-1:111111111:key/xxxx-xxx-xxxx-xxxxx)."
            },
            {
                "title": "Severity",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "severity",
                "options": [
                    "Critical",
                    "High",
                    "Medium",
                    "Low",
                    "Info"
                ],
                "tooltip": "Select severity to filter alerts.",
                "description": "(Optional) Select severity to filter alerts retrieved. You can select from the following options:  \n\nCritical \n\nHigh \n\nMedium \n\nLow \n\nInfo "
            },
            {
                "title": "Status",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "select",
                "name": "status",
                "options": [
                    "Compliant",
                    "NonCompliant"
                ],
                "tooltip": "Select the status to filter config data",
                "description": "(Optional) Select the status to filter config data retrieved. You can select from the following options:  \n\nCompliant \n\nNonCompliant "
            },
            {
                "title": "Returns",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "returns",
                "tooltip": "Specify comma-separated list of top-level fields of the response schema you want to receive. e.g. alertId, alertName, alertType, alertInfo.",
                "description": "(Optional) Specify comma-separated list of top-level fields of the response schema to receive. For example: alertId, alertName, alertType, alertInfo. "
            }
        ]
      },
      {
          "operation": "search_alerts",
          "title": "Search Alerts",
          "description": "Retrieves a detailed list of alerts based on filters like alert ID, start time, alert type, severity, status, and other filter criteria that you have specified.",
          "category": "investigation",
          "annotation": "search_alerts",
          "output_schema": [
              {
                  "alertId": "",
                  "startTime": "",
                  "alertType": "",
                  "severity": "",
                  "internetExposure": "",
                  "reachability": "",
                  "derivedFields": {
                      "category": "",
                      "sub_category": "",
                      "source": ""
                  },
                  "endTime": "",
                  "lastUserUpdatedTime": "",
                  "status": "",
                  "alertName": "",
                  "alertInfo": {
                      "subject": "",
                      "description": ""
                  },
                  "policyId": ""
              }
          ],
          "enabled": true,
          "parameters": [
              {
                  "title": "Start Time",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "datetime",
                  "name": "startTime",
                  "tooltip": "By default, the value is 24 hours before the current time. Difference between start time and end time should not be greater than 7 Days.",
                  "description": "(Optional) Specify the start time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is 24 hours before the current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
              },
              {
                  "title": "End Time",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "datetime",
                  "name": "endTime",
                  "tooltip": "By default, the value is current time. Difference between start time and end time should not be greater than 7 Days.",
                  "description": "(Optional) Specify the end time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
              },
              {
                  "title": "Alert ID",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "integer",
                  "name": "alertId",
                  "tooltip": "Specify an alert ID to retrieve the specified alert's details.",
                  "description": "(Optional) Specify an alert ID to retrieve the specified alert's details."
              },
              {
                  "title": "Alert Type",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "text",
                  "name": "alertType",
                  "tooltip": "Specify the alert type to filter alerts retrieved.",
                  "description": "(Optional) Specify the alert type to filter alerts retrieved."
              },
              {
                  "title": "Severity",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "select",
                  "name": "severity",
                  "options": [
                      "Critical",
                      "High",
                      "Medium",
                      "Low",
                      "Info"
                  ],
                  "tooltip": "Select severity to filter alerts.",
                  "description": "(Optional) Select severity to filter alerts retrieved. You can select from the following options:  \n\nCritical \n\nHigh \n\nMedium \n\nLow \n\nInfo "
              },
              {
                  "title": "Status",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "select",
                  "name": "status",
                  "options": [
                      "Open",
                      "InProgress",
                      "Closed"
                  ],
                  "tooltip": "Select the status to filter alerts",
                  "description": "(Optional) Select the status to filter alerts retrieved. You can select from the following options:  \n\nOpen \n\nInProgress \n\nClosed "
              },
              {
                  "title": "Alert Category",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "select",
                  "name": "category",
                  "options": [
                      "Policy",
                      "Anomaly",
                      "Composite"
                  ],
                  "tooltip": "Select the category to filter alerts",
                  "description": "(Optional) Select the category to filter alerts retrieved. You can select from the following options:  \n\nPolicy \n\nAnomaly \n\nComposite "
              },
              {
                  "title": "Alert Sub Category",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "select",
                  "name": "subCategory",
                  "options": [
                      "Compliance",
                      "Application",
                      "Cloud Activity",
                      "File",
                      "Machine",
                      "User",
                      "Platform",
                      "Kubernetes Activity",
                      "Registry",
                      "SystemCall",
                      "Threat Intel",
                      "Host Vulnerability",
                      "Container Vulnerability"
                  ],
                  "tooltip": "Select the sub category to filter alerts",
                  "description": "(Optional) Select the sub category to filter alerts retrieved. You can select from the following options:  \n\nCompliance \n\nApplication \n\nCloud Activity \n\nFile \n\nMachine \n\nUser \n\nPlatform \n\nKubernetes Activity \n\nRegistry \n\nSystemCall \n\nThreat Intel \n\nHost Vulnerability \n\nContainer Vulnerability "
              },
              {
                  "title": "Source",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "select",
                  "name": "source",
                  "options": [
                      "AWS",
                      "Azure",
                      "GCP",
                      "Agent",
                      "OCI",
                      "K8s"
                  ],
                  "tooltip": "Select the source to filter alerts",
                  "description": "(Optional) Select the source to filter alerts retrieved. You can select from the following options:  \n\nAWS \n\nAzure \n\nGCP \n\nAgent \n\nK8s \n\nOCI "
              },
              {
                  "title": "Returns",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "text",
                  "name": "returns",
                  "tooltip": "Specify comma-separated list of top-level fields of the response schema you want to receive. e.g. alertId, alertName, alertType, alertInfo.",
                  "description": "(Optional) Specify comma-separated list of top-level fields of the response schema to receive. For example: alertId, alertName, alertType, alertInfo. "
              }
          ]
      },
      {
          "operation": "get_alert_details",
          "title": "Get Alerts Details",
          "description": "Retrieves details about an alert based on the alert ID and scope you have specified.",
          "category": "investigation",
          "annotation": "get_alert_details",
          "conditional_output_schema": [
              {
                  "condition": "{{scope === 'Details'}}",
                  "output_schema": {
                      "data": {
                          "alertId": "",
                          "startTime": "",
                          "alertType": "",
                          "severity": "",
                          "endTime": "",
                          "lastUserUpdatedTime": "",
                          "status": "",
                          "alertName": "",
                          "alertInfo": {
                              "subject": "",
                              "description": "",
                              "isExpectedLWBehavior": "",
                              "customerCount": "",
                              "supportingFacts": [
                                  {
                                      "supportingFactText": "",
                                      "subElements": []
                                  }
                              ]
                          },
                          "entityMap": {
                              "API": "",
                              "CT_User": "",
                              "CT_RawTime": "",
                              "Region": "",
                              "Resource": "",
                              "RulesTriggered": "",
                              "SourceIpAddress": ""
                          }
                      }
                  }
              },
              {
                  "condition": "{{scope === 'Investigation'}}",
                  "output_schema": {
                      "data": [
                          {
                              "question": "",
                              "answer": ""
                          }
                      ]
                  }
              },
              {
                  "condition": "{{scope === 'Events'}}",
                  "output_schema": {
                      "data": [
                          {
                              "awsRegion": "",
                              "eventName": "",
                              "eventSource": "",
                              "sourceIpAddress": "",
                              "recipientAccountId": "",
                              "mfa": "",
                              "eventTime": "",
                              "userIdentity": "",
                              "additionalEventInfo": {
                                  "errorCode": "",
                                  "errorMessage": "",
                                  "eventID": "",
                                  "eventTime": "",
                                  "eventType": "",
                                  "eventVersion": "",
                                  "readOnly": "",
                                  "requestID": "",
                                  "userAgent": ""
                              },
                              "requestParameters": "",
                              "compositeEventId": "",
                              "id": "",
                              "name": "",
                              "descriptionText": "",
                              "compositeStartTime": "",
                              "compositeEndTime": "",
                              "entityKeys": [],
                              "tagMetadata": [
                                  {
                                      "tagMetadata": {
                                          "customerFacingId": "",
                                          "id": "",
                                          "name": "",
                                          "orderIndex": "",
                                          "parentId": "",
                                          "type": "",
                                          "url": "",
                                          "version": ""
                                      }
                                  }
                              ]
                          }
                      ]
                  }
              },
              {
                  "condition": "{{scope === 'RelatedAlerts'}}",
                  "output_schema": {
                      "data": [
                          {
                              "eventType": "",
                              "eventId": "",
                              "severity": "",
                              "startTime": "",
                              "endTime": "",
                              "eventModel": "",
                              "eventProps": {
                                  "description": "",
                                  "dstEntities": "",
                                  "eventActor": "",
                                  "srcEntities": ""
                              },
                              "keys": "",
                              "rank": "",
                              "eventInfo": {
                                  "subject": "",
                                  "description": ""
                              },
                              "eventName": ""
                          }
                      ]
                  }
              },
              {
                  "condition": "{{scope === 'Integrations'}}",
                  "output_schema": {
                      "data": [
                          {
                              "alertChannel": "",
                              "alertIntegrationId": "",
                              "createdTime": "",
                              "alertId": "",
                              "integrationType": "",
                              "integrationContext": {
                                  "id": "",
                                  "link": ""
                              },
                              "intgGuid": "",
                              "lastSyncTime": "",
                              "alertIntegrationStatus": "",
                              "status": "",
                              "isBidirectional": ""
                          }
                      ]
                  }
              },
              {
                  "condition": "{{scope === 'Timeline'}}",
                  "output_schema": {
                      "data": [
                          {
                              "alertChannel": "",
                              "id": "",
                              "alertId": "",
                              "createdTime": "",
                              "entryType": "",
                              "entryAuthorType": "",
                              "intgGuid": "",
                              "message": {},
                              "externalTime": "",
                              "user": "",
                              "updateContext": {
                                  "newIntegration": {
                                      "createdTime": "",
                                      "alertId": "",
                                      "lastSyncTime": "",
                                      "alertIntegrationStatus": "",
                                      "status": "",
                                      "isBidirectional": ""
                                  }
                              },
                              "alertIntegration": ""
                          }
                      ]
                  }
              }
          ],
          "enabled": true,
          "parameters": [
              {
                  "title": "Alert ID",
                  "required": true,
                  "editable": true,
                  "visible": true,
                  "type": "integer",
                  "name": "alertId",
                  "tooltip": "Specify an alert ID to retrieve the specified alert's details.",
                  "description": "Specify an alert ID to retrieve the specified alert's details."
              },
              {
                  "title": "Scope",
                  "required": true,
                  "editable": true,
                  "visible": true,
                  "type": "select",
                  "name": "scope",
                  "options": [
                      "Details",
                      "Investigation",
                      "Events",
                      "RelatedAlerts",
                      "Integrations",
                      "Timeline"
                  ],
                  "tooltip": "Select the scope to filter and limit the response retrieved.",
                  "description": "Select the scope to filter and limit the response retrieved. You can select from the following options: \n\nDetails \n\nInvestigation \n\nEvents \n\nRelatedAlerts \n\nIntegrations \n\nTimeline"
              }
          ]
      },
      {
          "operation": "get_alert_entities",
          "title": "Get Alert Entities",
          "description": "Retrieves a list of all entities associated with a specified alert ID for which additional context is available. The entity can be any non-compliant resource, such as a machine or IP address.",
          "category": "investigation",
          "annotation": "get_alert_entities",
          "output_schema": {
              "data": [
                  {
                      "entities": [
                          {
                              "entityValue": "",
                              "contextEntityType": ""
                          }
                      ],
                      "countOfEntities": ""
                  }
              ]
          },
          "enabled": true,
          "parameters": [
              {
                  "title": "Alert ID",
                  "required": true,
                  "editable": true,
                  "visible": true,
                  "type": "integer",
                  "name": "alertId",
                  "tooltip": "Specify an alert ID to retrieve the specified alert's entities.",
                  "description": "Specify an alert ID to retrieve the specified alert's entities."
              }
          ]
      },
      {
          "operation": "get_alert_entity_details",
          "title": "Get Alert Entity Details",
          "description": "Retrieves details about an entity associated with the specified alert ID for which additional context is available.",
          "category": "investigation",
          "annotation": "get_alert_entity_details",
          "conditional_output_schema": [
              {
                  "condition": "{{contextEntityType === 'IpAddress'}}",
                  "output_schema": {
                      "data": {
                          "isAgentInstalled": "",
                          "isInternalIp": "",
                          "laceworkLabs": {
                              "customerCount": "",
                              "badIpAddress": "",
                              "startTimeRange": "",
                              "endTimeRange": ""
                          },
                          "virusTotal": {
                              "securityVendorsCount": "",
                              "source": "",
                              "network": "",
                              "autonomousSystemNumber": "",
                              "autonomousSystemLabel": "",
                              "regionalInternalRegistry": "",
                              "country": "",
                              "continent": "",
                              "startTimeRange": "",
                              "endTimeRange": ""
                          },
                          "ipAddressSummary": {
                              "country": "",
                              "region": "",
                              "city": "",
                              "countryCode": "",
                              "startTimeRange": "",
                              "endTimeRange": ""
                          },
                          "resolvedIpInformation": {
                              "resolvedIPInfo": [
                                  {
                                      "dnsResolverIp": "",
                                      "dnsName": "",
                                      "resolvedIp": ""
                                  }
                              ],
                              "startTimeRange": "",
                              "endTimeRange": ""
                          },
                          "uniqueProcessDetails": {
                              "uniqueProcesses": [
                                  {
                                      "cmdLine": "",
                                      "launchTime": "",
                                      "hostname": ""
                                  }
                              ],
                              "startTimeRange": "",
                              "endTimeRange": ""
                          },
                          "networkActivityOverview": {
                              "externalServerConn": {
                                  "count": ""
                              },
                              "externalClientConn": {
                                  "count": ""
                              },
                              "externalInBytes": {
                                  "count": ""
                              },
                              "externalOutBytes": {
                                  "count": ""
                              },
                              "startTimeRange": "",
                              "endTimeRange": ""
                          }
                      }
                  }
              },
              {
                  "condition": "{{contextEntityType === 'Machine'}}",
                  "output_schema": {
                      "data": {
                          "criticalAndHighRisk": {
                              "vulnerabilities": {
                                  "criticalCount": "",
                                  "highCount": "",
                                  "startTimeRange": "",
                                  "endTimeRange": ""
                              },
                              "alerts": {
                                  "criticalCount": "",
                                  "highCount": "",
                                  "startTimeRange": "",
                                  "endTimeRange": ""
                              },
                              "attackPaths": {
                                  "criticalCount": "",
                                  "otherCount": "",
                                  "startTimeRange": "",
                                  "endTimeRange": ""
                              }
                          },
                          "customResourceGroups": {
                              "resourceGroups": [
                                  {
                                      "name": "",
                                      "guid": ""
                                  }
                              ],
                              "startTimeRange": "",
                              "endTimeRange": ""
                          },
                          "cloudServiceProvider": {
                              "cloudServiceProvider": "",
                              "accountAlias": "",
                              "accountId": "",
                              "startTimeRange": "",
                              "endTimeRange": ""
                          },
                          "machineProperties": {
                              "name": "",
                              "ipAddress": "",
                              "lastBootTime": "",
                              "cpu": "",
                              "osType": "",
                              "memoryInfo": "",
                              "kernelRelease": "",
                              "kernelVersion": "",
                              "macAddress": "",
                              "defaultRouter": "",
                              "promiscuous": "",
                              "startTimeRange": "",
                              "endTimeRange": ""
                          },
                          "machineTagSummary": {
                              "amiId": "",
                              "instanceId": "",
                              "subnetId": "",
                              "vmInstanceType": "",
                              "vmProvider": "",
                              "lwTokenShort": "",
                              "internalIp": "",
                              "arch": "",
                              "vpcId": "",
                              "zone": "",
                              "os": "",
                              "account": "",
                              "startTimeRange": "",
                              "endTimeRange": ""
                          },
                          "networkActivityOverview": {
                              "externalServerConn": {
                                  "count": ""
                              },
                              "externalClientConn": {
                                  "count": ""
                              },
                              "externalInBytes": {
                                  "count": ""
                              },
                              "externalOutBytes": {
                                  "count": ""
                              },
                              "startTimeRange": "",
                              "endTimeRange": ""
                          }
                      }
                  }
              }
          ],
          "enabled": true,
          "parameters": [
              {
                  "title": "Alert ID",
                  "required": true,
                  "editable": true,
                  "visible": true,
                  "type": "integer",
                  "name": "alertId",
                  "tooltip": "Specify an alert ID to retrieve the details about an entity associated with specified alert.",
                  "description": "Specify an alert ID to retrieve the details about an entity associated with specified alert."
              },
              {
                  "title": "Entity Type",
                  "required": true,
                  "editable": true,
                  "visible": true,
                  "type": "select",
                  "name": "contextEntityType",
                  "options": [
                      "IpAddress",
                      "Machine"
                  ],
                  "tooltip": "Select the type of entity.",
                  "description": "Select the type of entity. You can select from the following options: \n\nIpAddress \n\nMachine"
              },
              {
                  "title": "Entity Value",
                  "required": true,
                  "editable": true,
                  "visible": true,
                  "type": "text",
                  "name": "entityValue",
                  "tooltip": "Specify the corresponding entity value such as the Machine identifier (MID) or IP address for the selected entity type.",
                  "description": "Specify the corresponding entity value such as the Machine identifier (MID) or IP address for the selected entity type."
              }
          ]
      },
      {
          "operation": "add_comment_to_alert",
          "title": "Add Comment to Alert",
          "description": "Adds a user comment on an alert\u2019s timeline based on the alert ID you have specified.",
          "category": "investigation",
          "annotation": "add_comment_to_alert",
          "output_schema": {
              "data": {
                  "id": "",
                  "alertId": "",
                  "createdTime": "",
                  "entryType": "",
                  "entryAuthorType": "",
                  "message": {
                      "format": "",
                      "value": ""
                  },
                  "externalTime": "",
                  "user": {
                      "userGuid": "",
                      "username": ""
                  },
                  "updateContext": {}
              }
          },
          "enabled": true,
          "parameters": [
              {
                  "title": "Alert ID",
                  "required": true,
                  "editable": true,
                  "visible": true,
                  "type": "integer",
                  "name": "alertId",
                  "tooltip": "Specify an alert ID to add a user comment on the alert\u2019s timeline.",
                  "description": "Specify an alert ID to add a user comment on the alert\u2019s timeline."
              },
              {
                  "title": "Comment",
                  "required": true,
                  "editable": true,
                  "visible": true,
                  "type": "text",
                  "name": "comment",
                  "tooltip": "Specify the comment to be added to the alert\u2019s timeline.",
                  "description": "Specify the comment to be added to the alert\u2019s timeline."
              },
              {
                  "title": "Format",
                  "required": false,
                  "editable": true,
                  "visible": true,
                  "type": "select",
                  "name": "format",
                  "options": [
                      "Plaintext",
                      "Markdown"
                  ],
                  "tooltip": "Select the comment\u2019s format.",
                  "description": "(Optional) Select the comment's format. You can select from the following options:  \n\nPlaintext \n\nMarkdown "
              }
          ]
      },
      {
          "operation": "close_alert",
          "title": "Close Alert",
          "description": "Updates the status of an alert to closed. NOTE: A closed alert cannot be reopened.",
          "category": "investigation",
          "annotation": "close_alert",
          "output_schema": {
              "message": ""
          },
          "enabled": true,
          "parameters": [
              {
                  "title": "Alert ID",
                  "required": true,
                  "editable": true,
                  "visible": true,
                  "type": "integer",
                  "name": "alertId",
                  "tooltip": "Specify an alert ID to close the specified alert.",
                  "description": "Specify an alert ID to close the specified alert."
              },
              {
                  "title": "Reason",
                  "required": true,
                  "editable": true,
                  "visible": true,
                  "type": "select",
                  "options": [
                      "Other",
                      "False positive",
                      "Not enough information",
                      "Malicious and have resolution in place",
                      "Expected because of routine testing",
                      "Expected behavior"
                  ],
                  "onchange": {
                      "Other": [
                          {
                              "title": "Comment",
                              "required": true,
                              "editable": true,
                              "visible": true,
                              "type": "text",
                              "name": "comment",
                              "tooltip": "Specify a brief explanation of why the alert is closed.",
                              "description": "Specify a brief description for the selected reason."
                          }
                      ],
                      "False positive": [
                          {
                              "title": "Comment",
                              "required": false,
                              "editable": true,
                              "visible": true,
                              "type": "text",
                              "name": "comment",
                              "tooltip": "Specify a brief explanation of why the alert is closed.",
                              "description": "Specify a brief description for the selected reason."
                          }
                      ],
                      "Not enough information": [
                          {
                              "title": "Comment",
                              "required": false,
                              "editable": true,
                              "visible": true,
                              "type": "text",
                              "name": "comment",
                              "tooltip": "Specify a brief explanation of why the alert is closed.",
                              "description": "Specify a brief description for the selected reason."
                          }
                      ],
                      "Malicious and have resolution in place": [
                          {
                              "title": "Comment",
                              "required": false,
                              "editable": true,
                              "visible": true,
                              "type": "text",
                              "name": "comment",
                              "tooltip": "Specify a brief explanation of why the alert is closed.",
                              "description": "Specify a brief description for the selected reason."
                          }
                      ],
                      "Expected because of routine testing": [
                          {
                              "title": "Comment",
                              "required": false,
                              "editable": true,
                              "visible": true,
                              "type": "text",
                              "name": "comment",
                              "tooltip": "Specify a brief explanation of why the alert is closed.",
                              "description": "Specify a brief description for the selected reason."
                          }
                      ],
                      "Expected behavior": [
                          {
                              "title": "Comment",
                              "required": false,
                              "editable": true,
                              "visible": true,
                              "type": "text",
                              "name": "comment",
                              "tooltip": "Specify a brief explanation of why the alert is closed.",
                              "description": "Specify a brief description for the selected reason."
                          }
                      ]
                  },
                  "name": "reason",
                  "tooltip": "Select the reason for closing the alert.",
                  "description": "Select the reason for closing the alert. You can select from the following options:  \n\nOther \n\nFalse positive \n\nNot enough information \n\nMalicious and have resolution in place \n\nExpected because of routine testing \n\nExpected behavior"
              }
          ]
      }
  ],
  "cs_compatible": true,
  "help_online": "https://docs.fortinet.com/document/fortisoar/1.1.0/lacework-forticnapp/932/lacework-forticnapp-v1-1-0",
  "ingestion_modes": [
      "scheduled"
  ]
}