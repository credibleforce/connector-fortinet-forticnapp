{
  "name": "fortinet-forticnapp",
  "version": "1.1.0",
  "label": "Lacework FortiCNAPP",
  "description": "Lacework delivers end-to-end visibility into whatâ€™s happening across your cloud environment, including detecting threats, vulnerabilities, misconfigurations, and unusual activity, so you can innovate with speed and safety.",
  "publisher": "Fortinet",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "category": "Cloud Security",
  "configuration": {
    "fields": [
      {
        "title": "Server URL",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "server_url",
        "description": "Specify the URL of the Lacework server to connect and perform the automated operations.",
        "tooltip": "Specify the URL to which you will connect and perform the automated operations.",
        "isOnChange": false
      },
      {
        "title": "Key ID",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "keyId",
        "description": "Specify the access key ID configured for your account to access the Lacework endpoint.",
        "tooltip": "Specify the access key ID that is configured for your account to access the Lacework endpoint.",
        "isOnChange": false
      },
      {
        "title": "Secret Key",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "password",
        "name": "secret",
        "description": "Specify the secret key configured for your account to access the Lacework endpoint.",
        "tooltip": "Specify the secret key that is configured for your account to access the Lacework endpoint.",
        "isOnChange": false
      },
      {
        "title": "Verify SSL",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true,
        "description": "Specifies whether the SSL certificate for the server is to be verified. By default, this option is selected, i.e., set to true. ",
        "tooltip": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True.",
        "isOnChange": false
      }
    ]
  },
  "operations": [
    {
      "operation": "lql_query",
      "title": "Query lacework using LQL",
      "description": "Retrieves a list of results from an LQL query.",
      "category": "investigation",
      "annotation": "lql_query",
      "enabled": true,
      "parameters": [
        {
          "title": "Start Time",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "startTime",
          "tooltip": "By default, the value is 24 hours before the current time. Difference between start time and end time should not be greater than 7 Days.",
          "description": "(Optional) Specify the start time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is 24 hours before the current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
        },
        {
          "title": "End Time",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "endTime",
          "tooltip": "By default, the value is current time. Difference between start time and end time should not be greater than 7 Days.",
          "description": "(Optional) Specify the end time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
        },
        {
          "title": "Limit",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "limit",
          "tooltip": "Specify an limit to the number of rows returned.",
          "description": "(Optional) Specify an limit to the number of rows returned."
        },
        {
          "title": "Query",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "query",
          "tooltip": "Specify the LQL formatted query (e.g. {source {LW_CFG_AWS_EC2_SECURITY_GROUPS} return {RESOURCE_CONFIG}}).",
          "description": "(Optional) Specify the LQL formatted query (e.g. {source {LW_CFG_AWS_EC2_SECURITY_GROUPS} return {RESOURCE_CONFIG}})."
        }
      ],
      "output_schema": {}
    },
    {
      "operation": "search_host_vulnerabilities",
      "title": "Search Host Vulnerabilities",
      "description": "Retrieves a detailed list of vulnerability state based on filters like start time, account ID, severity, status, and other filter criteria that you have specified.",
      "category": "investigation",
      "annotation": "search_host_vulnerabilities",
      "enabled": true,
      "parameters": [
        {
          "name": "startTime",
          "title": "Start Time",
          "type": "datetime",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "By default, the value is 24 hours before the current time. Difference between start time and end time should not be greater than 7 Days.",
          "description": "(Optional) Specify the start time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is 24 hours before the current time. NOTE: Difference between start time and end time should not be greater than 7 Days.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "endTime",
          "title": "End Time",
          "type": "datetime",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "By default, the value is current time. Difference between start time and end time should not be greater than 7 Days.",
          "description": "(Optional) Specify the end time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is current time. NOTE: Difference between start time and end time should not be greater than 7 Days.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "packageStatus",
          "title": "Package Status",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select the package status to filter vulnerability data",
          "description": "Select the package status to filter config vulnerability retrieved. You can select from the following options:  \n\nACTIVE \n\nINACTIVE ",
          "options": [
            "ACTIVE",
            "INACTIVE"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "props__kernel_status",
          "title": "Kernel Status",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select the kernel status to filter vulnerability data",
          "description": "Select the kernel status to filter config vulnerability retrieved. You can select from the following options:  \n\nACTIVE \n\nINACTIVE ",
          "options": [
            "Active",
            "Inactive"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "riskInfo__host_risk_factors_breakdown__internet_reachability",
          "title": "Internet Reachability",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select the internet reachability to filter vulnerability data",
          "description": "Select the internet reachability to filter config vulnerability retrieved. You can select from the following options:  \n\nDirect ",
          "options": [
            "Direct"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "riskInfo__host_risk_factors_breakdown__exploit_summary__exploit_public",
          "title": "Public Exploit Available",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select the internet reachability to filter vulnerability data",
          "description": "Select the internet reachability to filter config vulnerability retrieved. You can select from the following options:  \n\nDirect ",
          "options": [
            "Yes",
            "No"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "fixInfo__fix_available",
          "title": "Fix Available",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify vulnerabilities with fix available to retrieve the specified vulnerability details.",
          "description": "(Optional) Specify vulnerabilities with fix available to retrieve the specified vulnerability details.",
          "options": [
            "0",
            "1"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "machineTags__Account",
          "title": "AWS Account ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an AWS Account ID to retrieve the specified vulnerability details.",
          "description": "(Optional) Specify an AWS Account ID to retrieve the specified vulnerability details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "machineTags__TenantId",
          "title": "Azure Tenant ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an Azure Tenant ID to retrieve the specified vulnerability details.",
          "description": "(Optional) Specify an Azure Tenant ID to retrieve the specified vulnerability details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "machineTags_SubscriptionId",
          "title": "Azure Subscription ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an Azure Subscription ID to retrieve the specified vulnerability details.",
          "description": "(Optional) Specify an Azure Subscription ID to retrieve the specified vulnerability details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "machineTags__ProjectId",
          "title": "GCP Project ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an GCP Project ID to retrieve the specified vulnerability details.",
          "description": "(Optional) Specify an GCP Project ID to retrieve the specified vulnerability details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "machineTags__InstanceId",
          "title": "AWS Instance ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an AWS instance ID to retrieve the specified vulnerability details (e.g. i-11112421523).",
          "description": "(Optional) Specify an AWS instance ID to retrieve the specified vulnerability details (e.g. i-11112421523).",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "machineTags__AmiId",
          "title": "AWS AMI ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an AWS AMI ID to retrieve the specified vulnerability details.",
          "description": "(Optional) Specify an AWS AMI ID to retrieve the specified vulnerability details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "machineTags__Hostname",
          "title": "Machine Hostname",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify a machine hostname to retrieve the specified vulnerability details.",
          "description": "(Optional) Specify a machine hostname to retrieve the specified vulnerability details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "machineTags__Name",
          "title": "Machine Name",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify a machine name to retrieve the specified vulnerability details.",
          "description": "(Optional) Specify a machine name to retrieve the specified vulnerability details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "severity",
          "title": "Severity",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select severity to filter vulnerabilities.",
          "description": "(Optional) Select severity to filter vulnerabilities retrieved. You can select from the following options:  \n\nCritical \n\nHigh \n\nMedium \n\nLow \n\nInfo ",
          "options": [
            "Critical",
            "High",
            "Medium",
            "Low",
            "Info"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "returns",
          "title": "Returns",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify comma-separated list of top-level fields of the response schema you want to receive. e.g. alertId, alertName, alertType, alertInfo.",
          "description": "(Optional) Specify comma-separated list of top-level fields of the response schema to receive. For example: alertId, alertName, alertType, alertInfo. ",
          "isOnChange": false,
          "onchange": {}
        }
      ],
      "output_schema": [
        {
          "cveProps": {},
          "cveRiskInfo": {},
          "cveRiskScore": {},
          "endTime": "",
          "evalCtx": {},
          "evalGuid": {},
          "featureKey": {},
          "fixInfo": {},
          "hostRiskInfo": {},
          "hostRiskScore": "",
          "machineTags": {},
          "mid": "",
          "packageStatus": "",
          "props": {},
          "region": "",
          "riskInfo": {},
          "riskScore": "",
          "severity": "",
          "startTime": "",
          "status": "",
          "vulnId": ""
        }
      ]
    },
    {
      "operation": "search_container_vulnerabilities",
      "title": "Search Container Vulnerabilities",
      "description": "Retrieves a detailed list of vulnerability state based on filters like start time, account ID, severity, status, and other filter criteria that you have specified.",
      "category": "investigation",
      "annotation": "search_container_vulnerabilities",
      "enabled": true,
      "parameters": [
        {
          "name": "startTime",
          "title": "Start Time",
          "type": "datetime",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "By default, the value is 24 hours before the current time. Difference between start time and end time should not be greater than 7 Days.",
          "description": "(Optional) Specify the start time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is 24 hours before the current time. NOTE: Difference between start time and end time should not be greater than 7 Days.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "endTime",
          "title": "End Time",
          "type": "datetime",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "By default, the value is current time. Difference between start time and end time should not be greater than 7 Days.",
          "description": "(Optional) Specify the end time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is current time. NOTE: Difference between start time and end time should not be greater than 7 Days.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "packageStatus",
          "title": "Package Status",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select the package status to filter vulnerability data",
          "description": "Select the package status to filter config vulnerability retrieved. You can select from the following options:  \n\nACTIVE \n\nINACTIVE ",
          "options": [
            "ACTIVE",
            "INACTIVE"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "imageRiskInfo__factors_breakdown__internet_reachability",
          "title": "Internet Reachability",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select the internet reachability to filter vulnerability data",
          "description": "Select the internet reachability to filter config vulnerability retrieved. You can select from the following options:  \n\nDirect ",
          "options": [
            "Direct"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "imageRiskInfo__factors_breakdown__exploit_summary__exploit_public",
          "title": "Public Exploit Available",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select the internet reachability to filter vulnerability data",
          "description": "Select the internet reachability to filter config vulnerability retrieved. You can select from the following options:  \n\nDirect ",
          "options": [
            "Yes",
            "No"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "imageId",
          "title": "Image ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an AWS Account ID to retrieve the specified vulnerability details.",
          "description": "(Optional) Specify an AWS Account ID to retrieve the specified vulnerability details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "fixInfo__fix_available",
          "title": "Fix Available",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify vulnerabilities with fix available to retrieve the specified vulnerability details.",
          "description": "(Optional) Specify vulnerabilities with fix available to retrieve the specified vulnerability details.",
          "options": [
            "0",
            "1"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "severity",
          "title": "Severity",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select severity to filter vulnerabilities.",
          "description": "(Optional) Select severity to filter vulnerabilities retrieved. You can select from the following options:  \n\nCritical \n\nHigh \n\nMedium \n\nLow \n\nInfo ",
          "options": [
            "Critical",
            "High",
            "Medium",
            "Low",
            "Info"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "returns",
          "title": "Returns",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify comma-separated list of top-level fields of the response schema you want to receive. e.g. alertId, alertName, alertType, alertInfo.",
          "description": "(Optional) Specify comma-separated list of top-level fields of the response schema to receive. For example: alertId, alertName, alertType, alertInfo. ",
          "isOnChange": false,
          "onchange": {}
        }
      ],
      "output_schema": [
        {
          "cveProps": {
            "description": "",
            "link": "",
            "source": ""
          },
          "cveRiskInfo": {
            "HOST_COUNT": "",
            "IMAGE_COUNT": "",
            "PKG_COUNT": "",
            "SEVERITY_LEVEL": "",
            "score": ""
          },
          "cveRiskScore": "",
          "evalCtx": {
            "collector_type": "",
            "cve_batch_info": [
              {
                "cve_created_time": ""
              }
            ],
            "image_info": {
              "created_time": "",
              "digest": "",
              "id": "",
              "registry": "",
              "repo": "",
              "scan_created_time": "",
              "size": "",
              "status": "",
              "tags": [],
              "type": ""
            },
            "integration_props": {},
            "is_reeval": "",
            "request_source": "",
            "scan_batch_id": "",
            "scan_request_props": {
              "data_format_version": "",
              "props": {
                "data_format_version": "",
                "scanner_version": ""
              },
              "scanCompletionUtcTime": "",
              "scan_start_time": "",
              "scanner_version": ""
            },
            "vuln_batch_id": "",
            "vuln_created_time": ""
          },
          "evalGuid": "",
          "featureKey": {
            "name": "",
            "namespace": "",
            "version": ""
          },
          "featureProps": {
            "feed": "",
            "introduced_in": "",
            "layer": "",
            "src": "",
            "version_format": ""
          },
          "fixInfo": {
            "fix_available": "",
            "fixed_version": ""
          },
          "imageId": "",
          "imageRiskInfo": {
            "factors": [],
            "factors_breakdown": {
              "active_containers": "",
              "cve_counts": {
                "Critical": "",
                "High": "",
                "Medium": "",
                "Other": ""
              },
              "exploit_summary": {
                "disclosure_in_wild": "",
                "exploit_public": "",
                "exploit_virus_malware": "",
                "exploit_wormified": ""
              },
              "internet_reachability": ""
            }
          },
          "imageRiskScore": "",
          "packageStatus": "",
          "riskInfo": {
            "factors": [],
            "factors_breakdown": {
              "active_containers": "",
              "cve_counts": {
                "Critical": "",
                "High": "",
                "Medium": "",
                "Other": ""
              },
              "exploit_summary": {
                "disclosure_in_wild": "",
                "exploit_public": "",
                "exploit_virus_malware": "",
                "exploit_wormified": ""
              },
              "internet_reachability": ""
            }
          },
          "riskScore": "",
          "severity": "",
          "startTime": "",
          "status": "",
          "vulnId": ""
        }
      ]
    },
    {
      "operation": "search_configuration",
      "title": "Search Configuration",
      "description": "Retrieves a detailed list of config state based on filters like policy ID, start time, account ID, severity, status, and other filter criteria that you have specified.",
      "category": "investigation",
      "annotation": "search_configuration",
      "enabled": true,
      "parameters": [
        {
          "name": "startTime",
          "title": "Start Time",
          "type": "datetime",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "By default, the value is 24 hours before the current time. Difference between start time and end time should not be greater than 7 Days.",
          "description": "(Optional) Specify the start time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is 24 hours before the current time. NOTE: Difference between start time and end time should not be greater than 7 Days.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "endTime",
          "title": "End Time",
          "type": "datetime",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "By default, the value is current time. Difference between start time and end time should not be greater than 7 Days.",
          "description": "(Optional) Specify the end time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is current time. NOTE: Difference between start time and end time should not be greater than 7 Days.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "dataset",
          "title": "Dataset",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": true,
          "tooltip": "Select the dataset to filter config data",
          "description": "Select the source to filter config data retrieved. You can select from the following options:  \n\nAwsCompliance \n\nAzureCompliance \n\nGcpCompliance \n\nK8sCompliance ",
          "options": [
            "AwsCompliance",
            "AzureCompliance",
            "GcpCompliance",
            "K8sCompliance"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "account__AccountId",
          "title": "AWS Account ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an AWS Account ID to retrieve the specified config details.",
          "description": "(Optional) Specify an AWS Account ID to retrieve the specified config details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "account__tenantId",
          "title": "Azure Tenant ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an Azure Tenant ID to retrieve the specified config details.",
          "description": "(Optional) Specify an Azure Tenant ID to retrieve the specified config details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "account__subscriptionId",
          "title": "Azure Subscription ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an Azure Subscription ID to retrieve the specified config details.",
          "description": "(Optional) Specify an Azure Subscription ID to retrieve the specified config details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "account__projectId",
          "title": "GCP Project ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify an GCP Project ID to retrieve the specified config details.",
          "description": "(Optional) Specify an GCP Project ID to retrieve the specified config details.",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "id",
          "title": "Policy ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify a policy ID to retrieve the specified config details (e.g. lacework-global-634).",
          "description": "(Optional) Specify a policy ID to retrieve the specified config details (e.g. lacework-global-634).",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "region",
          "title": "Region",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify a resgion to retrieve the specified config details (e.g. us-east-1).",
          "description": "(Optional) Specify a region ID to retrieve the specified config details (e.g. us-east-1).",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "resource",
          "title": "Resource ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify a resource ID to retrieve the specified config details (e.g. arn:aws:kms:us-east-1:111111111:key/xxxx-xxx-xxxx-xxxxx).",
          "description": "(Optional) Specify an alert ID to retrieve the specified config details (e.g. arn:aws:kms:us-east-1:111111111:key/xxxx-xxx-xxxx-xxxxx).",
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "severity",
          "title": "Severity",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select severity to filter alerts.",
          "description": "(Optional) Select severity to filter alerts retrieved. You can select from the following options:  \n\nCritical \n\nHigh \n\nMedium \n\nLow \n\nInfo ",
          "options": [
            "Critical",
            "High",
            "Medium",
            "Low",
            "Info"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "status",
          "title": "Status",
          "type": "select",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Select the status to filter config data",
          "description": "(Optional) Select the status to filter config data retrieved. You can select from the following options:  \n\nCompliant \n\nNonCompliant ",
          "options": [
            "Compliant",
            "NonCompliant"
          ],
          "isOnChange": false,
          "onchange": {}
        },
        {
          "name": "returns",
          "title": "Returns",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": false,
          "tooltip": "Specify comma-separated list of top-level fields of the response schema you want to receive. e.g. alertId, alertName, alertType, alertInfo.",
          "description": "(Optional) Specify comma-separated list of top-level fields of the response schema to receive. For example: alertId, alertName, alertType, alertInfo. ",
          "isOnChange": false,
          "onchange": {}
        }
      ],
      "output_schema": [
        {
          "account": {
            "AccountId": "",
            "Account_Alias": ""
          },
          "evalType": "",
          "id": "",
          "reason": "",
          "recommendation": "",
          "region": "",
          "reportTime": "",
          "resource": "",
          "section": "",
          "severity": "",
          "status": ""
        }
      ]
    },
    {
      "operation": "search_alerts",
      "title": "Search Alerts",
      "description": "Retrieves a detailed list of alerts based on filters like alert ID, start time, alert type, severity, status, and other filter criteria that you have specified.",
      "category": "investigation",
      "annotation": "search_alerts",
      "enabled": true,
      "parameters": [
        {
          "title": "Start Time",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "startTime",
          "tooltip": "By default, the value is 24 hours before the current time. Difference between start time and end time should not be greater than 7 Days.",
          "description": "(Optional) Specify the start time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is 24 hours before the current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
        },
        {
          "title": "End Time",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "datetime",
          "name": "endTime",
          "tooltip": "By default, the value is current time. Difference between start time and end time should not be greater than 7 Days.",
          "description": "(Optional) Specify the end time for search. Supported time formats: yyyy-MM-dd, yyyy-MM-ddTHH, yyyy-MM-ddTHH:mm:ssZ, yyyy-MM-ddTHH:mm:ss.SSSZ. By default, the value is current time. NOTE: Difference between start time and end time should not be greater than 7 Days."
        },
        {
          "title": "Alert ID",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "alertId",
          "tooltip": "Specify an alert ID to retrieve the specified alert\u0027s details.",
          "description": "(Optional) Specify an alert ID to retrieve the specified alert\u0027s details."
        },
        {
          "title": "Alert Type",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "alertType",
          "tooltip": "Specify the alert type to filter alerts retrieved.",
          "description": "(Optional) Specify the alert type to filter alerts retrieved."
        },
        {
          "title": "Severity",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "severity",
          "options": [
            "Critical",
            "High",
            "Medium",
            "Low",
            "Info"
          ],
          "tooltip": "Select severity to filter alerts.",
          "description": "(Optional) Select severity to filter alerts retrieved. You can select from the following options:  \n\nCritical \n\nHigh \n\nMedium \n\nLow \n\nInfo "
        },
        {
          "title": "Status",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "status",
          "options": [
            "Open",
            "InProgress",
            "Closed"
          ],
          "tooltip": "Select the status to filter alerts",
          "description": "(Optional) Select the status to filter alerts retrieved. You can select from the following options:  \n\nOpen \n\nInProgress \n\nClosed "
        },
        {
          "title": "Alert Category",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "category",
          "options": [
            "Policy",
            "Anomaly",
            "Composite"
          ],
          "tooltip": "Select the category to filter alerts",
          "description": "(Optional) Select the category to filter alerts retrieved. You can select from the following options:  \n\nPolicy \n\nAnomaly \n\nComposite "
        },
        {
          "title": "Alert Sub Category",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "subCategory",
          "options": [
            "Compliance",
            "Application",
            "Cloud Activity",
            "File",
            "Machine",
            "User",
            "Platform",
            "Kubernetes Activity",
            "Registry",
            "SystemCall",
            "Threat Intel",
            "Host Vulnerability",
            "Container Vulnerability"
          ],
          "tooltip": "Select the sub category to filter alerts",
          "description": "(Optional) Select the sub category to filter alerts retrieved. You can select from the following options:  \n\nCompliance \n\nApplication \n\nCloud Activity \n\nFile \n\nMachine \n\nUser \n\nPlatform \n\nKubernetes Activity \n\nRegistry \n\nSystemCall \n\nThreat Intel \n\nHost Vulnerability \n\nContainer Vulnerability "
        },
        {
          "title": "Source",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "source",
          "options": [
            "AWS",
            "Azure",
            "GCP",
            "Agent",
            "OCI",
            "K8s"
          ],
          "tooltip": "Select the source to filter alerts",
          "description": "(Optional) Select the source to filter alerts retrieved. You can select from the following options:  \n\nAWS \n\nAzure \n\nGCP \n\nAgent \n\nK8s \n\nOCI "
        },
        {
          "title": "Returns",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "returns",
          "tooltip": "Specify comma-separated list of top-level fields of the response schema you want to receive. e.g. alertId, alertName, alertType, alertInfo.",
          "description": "(Optional) Specify comma-separated list of top-level fields of the response schema to receive. For example: alertId, alertName, alertType, alertInfo. "
        }
      ],
      "output_schema": ""
    },
    {
      "operation": "get_alert_details",
      "title": "Get Alerts Details",
      "description": "Retrieves details about an alert based on the alert ID and scope you have specified.",
      "category": "investigation",
      "annotation": "get_alert_details",
      "conditional_output_schema": [
        {
          "condition": "{{scope \u003d\u003d\u003d \u0027Details\u0027}}",
          "output_schema": {
            "data": {
              "alertId": "",
              "startTime": "",
              "alertType": "",
              "severity": "",
              "endTime": "",
              "lastUserUpdatedTime": "",
              "status": "",
              "alertName": "",
              "alertInfo": {
                "subject": "",
                "description": "",
                "isExpectedLWBehavior": "",
                "customerCount": "",
                "supportingFacts": [
                  {
                    "supportingFactText": "",
                    "subElements": []
                  }
                ]
              },
              "entityMap": {
                "API": "",
                "CT_User": "",
                "CT_RawTime": "",
                "Region": "",
                "Resource": "",
                "RulesTriggered": "",
                "SourceIpAddress": ""
              }
            }
          }
        },
        {
          "condition": "{{scope \u003d\u003d\u003d \u0027Investigation\u0027}}",
          "output_schema": {
            "data": [
              {
                "question": "",
                "answer": ""
              }
            ]
          }
        },
        {
          "condition": "{{scope \u003d\u003d\u003d \u0027Events\u0027}}",
          "output_schema": {
            "data": [
              {
                "awsRegion": "",
                "eventName": "",
                "eventSource": "",
                "sourceIpAddress": "",
                "recipientAccountId": "",
                "mfa": "",
                "eventTime": "",
                "userIdentity": "",
                "additionalEventInfo": {
                  "errorCode": "",
                  "errorMessage": "",
                  "eventID": "",
                  "eventTime": "",
                  "eventType": "",
                  "eventVersion": "",
                  "readOnly": "",
                  "requestID": "",
                  "userAgent": ""
                },
                "requestParameters": "",
                "compositeEventId": "",
                "id": "",
                "name": "",
                "descriptionText": "",
                "compositeStartTime": "",
                "compositeEndTime": "",
                "entityKeys": [],
                "tagMetadata": [
                  {
                    "tagMetadata": {
                      "customerFacingId": "",
                      "id": "",
                      "name": "",
                      "orderIndex": "",
                      "parentId": "",
                      "type": "",
                      "url": "",
                      "version": ""
                    }
                  }
                ]
              }
            ]
          }
        },
        {
          "condition": "{{scope \u003d\u003d\u003d \u0027RelatedAlerts\u0027}}",
          "output_schema": {
            "data": [
              {
                "eventType": "",
                "eventId": "",
                "severity": "",
                "startTime": "",
                "endTime": "",
                "eventModel": "",
                "eventProps": {
                  "description": "",
                  "dstEntities": "",
                  "eventActor": "",
                  "srcEntities": ""
                },
                "keys": "",
                "rank": "",
                "eventInfo": {
                  "subject": "",
                  "description": ""
                },
                "eventName": ""
              }
            ]
          }
        },
        {
          "condition": "{{scope \u003d\u003d\u003d \u0027Integrations\u0027}}",
          "output_schema": {
            "data": [
              {
                "alertChannel": "",
                "alertIntegrationId": "",
                "createdTime": "",
                "alertId": "",
                "integrationType": "",
                "integrationContext": {
                  "id": "",
                  "link": ""
                },
                "intgGuid": "",
                "lastSyncTime": "",
                "alertIntegrationStatus": "",
                "status": "",
                "isBidirectional": ""
              }
            ]
          }
        },
        {
          "condition": "{{scope \u003d\u003d\u003d \u0027Timeline\u0027}}",
          "output_schema": {
            "data": [
              {
                "alertChannel": "",
                "id": "",
                "alertId": "",
                "createdTime": "",
                "entryType": "",
                "entryAuthorType": "",
                "intgGuid": "",
                "message": {},
                "externalTime": "",
                "user": "",
                "updateContext": {
                  "newIntegration": {
                    "createdTime": "",
                    "alertId": "",
                    "lastSyncTime": "",
                    "alertIntegrationStatus": "",
                    "status": "",
                    "isBidirectional": ""
                  }
                },
                "alertIntegration": ""
              }
            ]
          }
        }
      ],
      "enabled": true,
      "parameters": [
        {
          "title": "Alert ID",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "alertId",
          "tooltip": "Specify an alert ID to retrieve the specified alert\u0027s details.",
          "description": "Specify an alert ID to retrieve the specified alert\u0027s details."
        },
        {
          "title": "Scope",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "scope",
          "options": [
            "Details",
            "Investigation",
            "Events",
            "RelatedAlerts",
            "Integrations",
            "Timeline"
          ],
          "tooltip": "Select the scope to filter and limit the response retrieved.",
          "description": "Select the scope to filter and limit the response retrieved. You can select from the following options: \n\nDetails \n\nInvestigation \n\nEvents \n\nRelatedAlerts \n\nIntegrations \n\nTimeline"
        }
      ]
    },
    {
      "operation": "get_alert_entities",
      "title": "Get Alert Entities",
      "description": "Retrieves a list of all entities associated with a specified alert ID for which additional context is available. The entity can be any non-compliant resource, such as a machine or IP address.",
      "category": "investigation",
      "annotation": "get_alert_entities",
      "enabled": true,
      "parameters": [
        {
          "title": "Alert ID",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "alertId",
          "tooltip": "Specify an alert ID to retrieve the specified alert\u0027s entities.",
          "description": "Specify an alert ID to retrieve the specified alert\u0027s entities."
        }
      ],
      "output_schema": {
        "data": [
          {
            "entities": [
              {
                "entityValue": "",
                "contextEntityType": ""
              }
            ],
            "countOfEntities": ""
          }
        ]
      }
    },
    {
      "operation": "get_alert_entity_details",
      "title": "Get Alert Entity Details",
      "description": "Retrieves details about an entity associated with the specified alert ID for which additional context is available.",
      "category": "investigation",
      "annotation": "get_alert_entity_details",
      "conditional_output_schema": [
        {
          "condition": "{{contextEntityType \u003d\u003d\u003d \u0027IpAddress\u0027}}",
          "output_schema": {
            "data": {
              "isAgentInstalled": "",
              "isInternalIp": "",
              "laceworkLabs": {
                "customerCount": "",
                "badIpAddress": "",
                "startTimeRange": "",
                "endTimeRange": ""
              },
              "virusTotal": {
                "securityVendorsCount": "",
                "source": "",
                "network": "",
                "autonomousSystemNumber": "",
                "autonomousSystemLabel": "",
                "regionalInternalRegistry": "",
                "country": "",
                "continent": "",
                "startTimeRange": "",
                "endTimeRange": ""
              },
              "ipAddressSummary": {
                "country": "",
                "region": "",
                "city": "",
                "countryCode": "",
                "startTimeRange": "",
                "endTimeRange": ""
              },
              "resolvedIpInformation": {
                "resolvedIPInfo": [
                  {
                    "dnsResolverIp": "",
                    "dnsName": "",
                    "resolvedIp": ""
                  }
                ],
                "startTimeRange": "",
                "endTimeRange": ""
              },
              "uniqueProcessDetails": {
                "uniqueProcesses": [
                  {
                    "cmdLine": "",
                    "launchTime": "",
                    "hostname": ""
                  }
                ],
                "startTimeRange": "",
                "endTimeRange": ""
              },
              "networkActivityOverview": {
                "externalServerConn": {
                  "count": ""
                },
                "externalClientConn": {
                  "count": ""
                },
                "externalInBytes": {
                  "count": ""
                },
                "externalOutBytes": {
                  "count": ""
                },
                "startTimeRange": "",
                "endTimeRange": ""
              }
            }
          }
        },
        {
          "condition": "{{contextEntityType \u003d\u003d\u003d \u0027Machine\u0027}}",
          "output_schema": {
            "data": {
              "criticalAndHighRisk": {
                "vulnerabilities": {
                  "criticalCount": "",
                  "highCount": "",
                  "startTimeRange": "",
                  "endTimeRange": ""
                },
                "alerts": {
                  "criticalCount": "",
                  "highCount": "",
                  "startTimeRange": "",
                  "endTimeRange": ""
                },
                "attackPaths": {
                  "criticalCount": "",
                  "otherCount": "",
                  "startTimeRange": "",
                  "endTimeRange": ""
                }
              },
              "customResourceGroups": {
                "resourceGroups": [
                  {
                    "name": "",
                    "guid": ""
                  }
                ],
                "startTimeRange": "",
                "endTimeRange": ""
              },
              "cloudServiceProvider": {
                "cloudServiceProvider": "",
                "accountAlias": "",
                "accountId": "",
                "startTimeRange": "",
                "endTimeRange": ""
              },
              "machineProperties": {
                "name": "",
                "ipAddress": "",
                "lastBootTime": "",
                "cpu": "",
                "osType": "",
                "memoryInfo": "",
                "kernelRelease": "",
                "kernelVersion": "",
                "macAddress": "",
                "defaultRouter": "",
                "promiscuous": "",
                "startTimeRange": "",
                "endTimeRange": ""
              },
              "machineTagSummary": {
                "amiId": "",
                "instanceId": "",
                "subnetId": "",
                "vmInstanceType": "",
                "vmProvider": "",
                "lwTokenShort": "",
                "internalIp": "",
                "arch": "",
                "vpcId": "",
                "zone": "",
                "os": "",
                "account": "",
                "startTimeRange": "",
                "endTimeRange": ""
              },
              "networkActivityOverview": {
                "externalServerConn": {
                  "count": ""
                },
                "externalClientConn": {
                  "count": ""
                },
                "externalInBytes": {
                  "count": ""
                },
                "externalOutBytes": {
                  "count": ""
                },
                "startTimeRange": "",
                "endTimeRange": ""
              }
            }
          }
        }
      ],
      "enabled": true,
      "parameters": [
        {
          "title": "Alert ID",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "alertId",
          "tooltip": "Specify an alert ID to retrieve the details about an entity associated with specified alert.",
          "description": "Specify an alert ID to retrieve the details about an entity associated with specified alert."
        },
        {
          "title": "Entity Type",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "contextEntityType",
          "options": [
            "IpAddress",
            "Machine"
          ],
          "tooltip": "Select the type of entity.",
          "description": "Select the type of entity. You can select from the following options: \n\nIpAddress \n\nMachine"
        },
        {
          "title": "Entity Value",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "entityValue",
          "tooltip": "Specify the corresponding entity value such as the Machine identifier (MID) or IP address for the selected entity type.",
          "description": "Specify the corresponding entity value such as the Machine identifier (MID) or IP address for the selected entity type."
        }
      ]
    },
    {
      "operation": "add_comment_to_alert",
      "title": "Add Comment to Alert",
      "description": "Adds a user comment on an alertâ€™s timeline based on the alert ID you have specified.",
      "category": "investigation",
      "annotation": "add_comment_to_alert",
      "enabled": true,
      "parameters": [
        {
          "title": "Alert ID",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "alertId",
          "tooltip": "Specify an alert ID to add a user comment on the alertâ€™s timeline.",
          "description": "Specify an alert ID to add a user comment on the alertâ€™s timeline."
        },
        {
          "title": "Comment",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "comment",
          "tooltip": "Specify the comment to be added to the alertâ€™s timeline.",
          "description": "Specify the comment to be added to the alertâ€™s timeline."
        },
        {
          "title": "Format",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "select",
          "name": "format",
          "options": [
            "Plaintext",
            "Markdown"
          ],
          "tooltip": "Select the commentâ€™s format.",
          "description": "(Optional) Select the comment\u0027s format. You can select from the following options:  \n\nPlaintext \n\nMarkdown "
        }
      ],
      "output_schema": {
        "data": {
          "id": "",
          "alertId": "",
          "createdTime": "",
          "entryType": "",
          "entryAuthorType": "",
          "message": {
            "format": "",
            "value": ""
          },
          "externalTime": "",
          "user": {
            "userGuid": "",
            "username": ""
          },
          "updateContext": {}
        }
      }
    },
    {
      "operation": "close_alert",
      "title": "Close Alert",
      "description": "Updates the status of an alert to closed. NOTE: A closed alert cannot be reopened.",
      "category": "investigation",
      "annotation": "close_alert",
      "enabled": true,
      "parameters": [
        {
          "title": "Alert ID",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "alertId",
          "tooltip": "Specify an alert ID to close the specified alert.",
          "description": "Specify an alert ID to close the specified alert."
        },
        {
          "title": "Reason",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "select",
          "options": [
            "Other",
            "False positive",
            "Not enough information",
            "Malicious and have resolution in place",
            "Expected because of routine testing",
            "Expected behavior"
          ],
          "onchange": {
            "Other": [
              {
                "title": "Comment",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "comment",
                "tooltip": "Specify a brief explanation of why the alert is closed.",
                "description": "Specify a brief description for the selected reason.",
                "isOnChange": true,
                "onChangeParam": "Reason",
                "onChangeOption": "Other"
              }
            ],
            "False positive": [
              {
                "title": "Comment",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "comment",
                "tooltip": "Specify a brief explanation of why the alert is closed.",
                "description": "Specify a brief description for the selected reason.",
                "isOnChange": true,
                "onChangeParam": "Reason",
                "onChangeOption": "False positive"
              }
            ],
            "Not enough information": [
              {
                "title": "Comment",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "comment",
                "tooltip": "Specify a brief explanation of why the alert is closed.",
                "description": "Specify a brief description for the selected reason.",
                "isOnChange": true,
                "onChangeParam": "Reason",
                "onChangeOption": "Not enough information"
              }
            ],
            "Malicious and have resolution in place": [
              {
                "title": "Comment",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "comment",
                "tooltip": "Specify a brief explanation of why the alert is closed.",
                "description": "Specify a brief description for the selected reason.",
                "isOnChange": true,
                "onChangeParam": "Reason",
                "onChangeOption": "Malicious and have resolution in place"
              }
            ],
            "Expected because of routine testing": [
              {
                "title": "Comment",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "comment",
                "tooltip": "Specify a brief explanation of why the alert is closed.",
                "description": "Specify a brief description for the selected reason.",
                "isOnChange": true,
                "onChangeParam": "Reason",
                "onChangeOption": "Expected because of routine testing"
              }
            ],
            "Expected behavior": [
              {
                "title": "Comment",
                "required": false,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "comment",
                "tooltip": "Specify a brief explanation of why the alert is closed.",
                "description": "Specify a brief description for the selected reason.",
                "isOnChange": true,
                "onChangeParam": "Reason",
                "onChangeOption": "Expected behavior"
              }
            ]
          },
          "name": "reason",
          "tooltip": "Select the reason for closing the alert.",
          "description": "Select the reason for closing the alert. You can select from the following options:  \n\nOther \n\nFalse positive \n\nNot enough information \n\nMalicious and have resolution in place \n\nExpected because of routine testing \n\nExpected behavior"
        }
      ],
      "output_schema": {
        "message": ""
      }
    }
  ],
  "cs_compatible": true,
  "help_online": "https://docs.fortinet.com/document/fortisoar/1.1.0/lacework-forticnapp/932/lacework-forticnapp-v1-1-0",
  "ingestion_modes": [
    "scheduled"
  ],
  "cs_approved": false
}